# Polling, Long Polling, Streaming

> **프로필 이미지를 AI서버로 전송시켜 훈련 및 추론과정을 거쳐서 프로필 이미지를 생성하는 과정에서 API 서버와 AI 서버간의 통신을 Polling 방식으로 구현하려고 계획하고 있다. 아무래도 담당자가 나여서 Polling 방식에 대해서 알고는 있어야 할 것 같아서 이렇게 정리하게 되었다.**

HTTP 통신은 클라이언트에서 서버로의 단방향 통신을 위해 만들어진 기술로, WebSocket이 등장하기 전에는 실시간 통신을 위해서 HTTP 통신에 약간의 트릭을 활용해서 실시간인 것처럼 작동하게 하는 기술이 구현되었는데 대표적으로는 Polling, Long-Polling, Streaming이 있다.

## Polling

> **가장 기본적인 데이터 처리방식으로, 특정 주기를 가지고 서버에 HTTP Request를 보내는 방식이다.**

폴링은 리얼타임 웹을 위한 기법으로 일정한 주기를 가지고 서버와 응답을 주고 받는 방식이다. 이렇게 하는 이유는 웹이 태생 자체부터 실시간을 위해 필수적인 `Persistent Connection(영구적인 연결)`이 불가능하기 때문이다. 왜냐하면 클라이언트가 서버에게 특정 요청을 하면 서버가 응답해주고 나서 연결이 끊어지는것이 HTTP의 특징이기 때문이다.

그래서 실시간 서비스라고 불리는 서비스들은 대부분이 실시간이 아니다. 실시간으로 변하는 야구 중계 같은 경우에는 브라우저에서 5초 단위로 서버에 요청을 보내 업데이트 하는 방식으로 구현된다고 한다.

하지만 단점으로는 폴링의 주기가 짧으면 서버의 성능에 부담이 간다. 그리고 주기가 길게되면 실시간성이 떨어진다.

## Long Polling

> **Polling과 비슷한 기법이지만 실시간으로 데이터를 처리할 수 있는 방식이다.**

Long-Polling은 클라이언트에서 서버로 일단 HTTP 요청을 보내고, 이 상태로 계속 기다리다가 서버에서 해당 클라이언트로 전달할 이벤트가 있다면 그 순간 Response 메세지를 전달하면서 연결이 종료된다. 작업이 완료된 이후에는 클라이언트에서 곧바로 다시 HTTP 요청을 보내서 서버의 다음 이벤트를 기다리게 되는 작업 방식이다.

일반 Polling 방식과 비교해보면 서버의 부담이 줄어든다는 장점이 있지만 클라이언트에게 동시에 많은 양의 메세지가 올 경우 결국에는 일반 폴링과 다른 점이 없다.

## Streaming

> **일반적인 TCP Connection과 비슷하며 클라이언트와 서버간 연결된 연결 통로로 데이터를 보내는 방식이다.**

Streaming은 Long-Polling과 마찬가지로 처음에는 클라이언트에서 서버로 HTTP 요청을 보낸다.

서버에서 클라이언트로 이벤트를 전달할 때 해당 요청을 끊지 않고 필요한 메세지만 보내기를 반복하는 방식이다. 서버에서 메세지를 보내고 나서 다시 HTTP 요청을 하지 않아도 되기 때문에 Long-Polling에 비해 부담이 덜하다.

---

위의 3가지 방식은 모두 HTTP를 통해 통신하기 때문에 불필요하게 Header가 크다는 단점이 있다. 그래서 양방향 통신이 가능하게 하기 위해서 WebSocket이 만들어졌다고 이해하면 될 것 같다.
